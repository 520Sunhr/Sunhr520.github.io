<p>```cpp<br>#include &lt;bits/stdc++.h&gt;<br>using namespace std;<br>typedef long long ll;</p>
<p>inline void Max(int &amp;a, int b)<br>{<br>    if (a &lt; b)<br>        a = b;<br>}<br>const int N = 5e3 + 100;<br>int a[N];<br>int f[N], g[N], c[N]; //��������-&gt;������� fǰ׺���ֵ ��ֵ����</p>
<p>int main()<br>{<br>    int n, k, s; //��Ʒ ���� �ܺ�<br>    cin &gt;&gt; n &gt;&gt; k &gt;&gt; s;<br>    for (int i = 0; i &lt; n; ++i)<br>        scanf(“%d”, &amp;a[i]);<br>    memset(f, -0x3f, sizeof(f)); f[0] = 0;<br>    for (int i = 0; i &lt; k; ++i) //ö����<br>    {<br>        memset(g, 0, sizeof(g));<br>        memset(c, 0, sizeof(c));<br>        vector<int> vec;<br>        for (int j = 0; j * k + i &lt; n; ++j) //����k�������鲢ͳ�ƴ���<br>            if (c[a[j * k + i]]++ == 0)<br>                vec.push_back(a[j * k + i]);<br>        for (int j = 0; j &lt;= s; ++j)<br>            g[j] = max((j ? g[j - 1] : 0), f[j]);<br>        for (int j = s; j &gt;= 0; –j) //��������<br>        {<br>            f[j] += c[0]; //���Ϊ0����Ʒ��Ҫ������֮ǰת��<br>            for (auto v : vec)<br>                if (v &amp;&amp; j &gt;= v)<br>                    Max(f[j], f[j - v] + c[v]);<br>            Max(f[j], g[j]); //������һ�������ڵ�����<br>        }<br>    }<br>    cout &lt;&lt; n - f[s] &lt;&lt; endl;</p>
<pre><code>return 0;</code></pre><p>}</p>
