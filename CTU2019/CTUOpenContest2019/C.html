<hr>
<p>title: Beer Coasters<br>date: 2000-2-16 15:16:17<br>categories:<br>    - CTU2019<br>tags:<br>    - conceal<br>mp3: <a href="http://domain.com/awesome.mp3" target="_blank" rel="noopener">http://domain.com/awesome.mp3</a></p>
<hr>
<p>Often, in an average pub, the beer is served in a mug which is, quite obviously, wet from inside,but also wet from outside. The barkeeper typically has no capacity to dry freshly washedmugs. To protect the table and the (optional!) tablecloth, beer coasters are used in mostpubs. Originally, the beer coasters were round, nowadays you can fifind a variety of difffferentshapes. Despite being perceived as slightly unorthodox, square and even rectangular coastersare manufactured and used daily in many self-respecting restaurants, taverns, beer houses anddrinkeries of high and low profifiles.</p>
<p>A research related to the well-known satiric Ig Nobel Prize is being conducted in local pubs.The research aims to measure the rate of wear of the rectangular coasters. The rate of weardepends also on how much a coaster is getting wet from the contact with the wet bottom of beermugs. That, in turn, depends on the exact area of contact between the mug and the coaster.The exact position of the coaster and the mug on the table is recorded each time the mug is puton the coaster.</p>
<p>Manysophisticatedcalculationsintheresearchtakeasinputtheareaofcontact,whichhasto becalculatedbyasuitablecomputerprogram.Youaretowritesuchaprogram.</p>
<ul>
<li>Input Specification </li>
</ul>
<p>The input contains 7 space-separated integers on a single line. The fifirst three integers X, Y , R describe the coordinates of the beer mug bottom on the table. The center of the mug bottom is at (X, Y ) and the radius of the mug bottom is R. The next four integers Ax, Ay, Bx, By describe the coordinates of two opposite corners, (Ax, Ay) and (Bx, By), of the coaster on the table. The coaster is a rectangle placed with its sides parallel to the coordinate axes. All coordinates are in the range from m 1000 to 1000, the radius is in the range from 1 to 1000. The radius and the coordinates are expressed in the same units of length.</p>
<ul>
<li>Output Specifification </li>
</ul>
<p>Output a single decimal number with precision of 4 digits after the decimal point, the area of contact between the coaster and the beer mug. </p>
<p>本题答案不唯一，符合要求的答案均正确</p>
<p>样例输入</p>
<pre><code>-1 0 2 -1 -2 3 2</code></pre><p>样例输出</p>
<pre><code>6.2832</code></pre><h4 id="题目大意"><a href="#题目大意" class="headerlink" title="题目大意"></a>题目大意</h4><p>   给定一个圆心坐标和半径，一个矩形的两个不相邻的顶点，求其相交的面积</p>
<h4 id="解题思路"><a href="#解题思路" class="headerlink" title="解题思路"></a>解题思路</h4><p>   求圆与凸多边形相交面积模板<br>   //wtf？？这是个啥板子？？</p>
<h4 id="AC码"><a href="#AC码" class="headerlink" title="AC码"></a>AC码</h4><p>注：看了两份。。几乎相同，好像就是个板子题。。虽然我不知道板子-=-<br>    先附了一份学长crf大佬的AC码</p>
<pre><code class="cpp"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span>
<span class="meta">#<span class="meta-keyword">define</span> inf 1000000000000</span>
<span class="meta">#<span class="meta-keyword">define</span> M 100009</span>
<span class="meta">#<span class="meta-keyword">define</span> eps 1e-12</span>
<span class="meta">#<span class="meta-keyword">define</span> PI acos(-1.0)</span>
<span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;
<span class="class"><span class="keyword">struct</span> <span class="title">Point</span></span>
<span class="class">{</span>
    <span class="keyword">double</span> x,y;
    Point(){}
    Point(<span class="keyword">double</span> xx,<span class="keyword">double</span> yy){x=xx;y=yy;}
    Point <span class="keyword">operator</span> -(Point s){<span class="keyword">return</span> Point(x-s.x,y-s.y);}
    Point <span class="keyword">operator</span> +(Point s){<span class="keyword">return</span> Point(x+s.x,y+s.y);}
    <span class="keyword">double</span> <span class="keyword">operator</span> *(Point s){<span class="keyword">return</span> x*s.x+y*s.y;}
    <span class="keyword">double</span> <span class="keyword">operator</span> ^(Point s){<span class="keyword">return</span> x*s.y-y*s.x;}
}p[M];
<span class="function"><span class="keyword">double</span> <span class="title">max</span><span class="params">(<span class="keyword">double</span> a,<span class="keyword">double</span> b)</span></span>{<span class="keyword">return</span> a&gt;b?a:b;}
<span class="function"><span class="keyword">double</span> <span class="title">min</span><span class="params">(<span class="keyword">double</span> a,<span class="keyword">double</span> b)</span></span>{<span class="keyword">return</span> a&lt;b?a:b;}
<span class="function"><span class="keyword">double</span> <span class="title">len</span><span class="params">(Point a)</span></span>{<span class="keyword">return</span> <span class="built_in">sqrt</span>(a*a);}
<span class="function"><span class="keyword">double</span> <span class="title">dis</span><span class="params">(Point a,Point b)</span></span>{<span class="keyword">return</span> len(b-a);}<span class="comment">//两点之间的距离</span>
<span class="function"><span class="keyword">double</span> <span class="title">cross</span><span class="params">(Point a,Point b,Point c)</span><span class="comment">//叉乘</span></span>
<span class="function"></span>{
    <span class="keyword">return</span> (b-a)^(c-a);
}
<span class="function"><span class="keyword">double</span> <span class="title">dot</span><span class="params">(Point a,Point b,Point c)</span><span class="comment">//点乘 </span></span>
<span class="function"></span>{
    <span class="keyword">return</span> (b-a)*(c-a);
}
<span class="function"><span class="keyword">int</span> <span class="title">judge</span><span class="params">(Point a,Point b,Point c)</span><span class="comment">//判断c是否在ab线段上（前提是c在直线ab上）</span></span>
<span class="function"></span>{
    <span class="keyword">if</span> (c.x&gt;=min(a.x,b.x)
       &amp;&amp;c.x&lt;=max(a.x,b.x)
       &amp;&amp;c.y&gt;=min(a.y,b.y)
       &amp;&amp;c.y&lt;=max(a.y,b.y)) <span class="keyword">return</span> <span class="number">1</span>;
    <span class="keyword">return</span> <span class="number">0</span>;
}
<span class="function"><span class="keyword">double</span> <span class="title">area</span><span class="params">(Point b,Point c,<span class="keyword">double</span> r)</span></span>
<span class="function"></span>{
    <span class="function">Point <span class="title">a</span><span class="params">(<span class="number">0.0</span>,<span class="number">0.0</span>)</span></span>;
    <span class="keyword">if</span>(dis(b,c)&lt;eps) <span class="keyword">return</span> <span class="number">0.0</span>;
    <span class="keyword">double</span> h=<span class="built_in">fabs</span>(cross(a,b,c))/dis(b,c);
    <span class="keyword">if</span>(dis(a,b)&gt;r-eps&amp;&amp;dis(a,c)&gt;r-eps)<span class="comment">//两个端点都在圆的外面则分为两种情况</span>
    {
        <span class="keyword">double</span> angle=<span class="built_in">acos</span>(dot(a,b,c)/dis(a,b)/dis(a,c));
        <span class="keyword">if</span>(h&gt;r-eps) <span class="keyword">return</span> <span class="number">0.5</span>*r*r*angle;<span class="keyword">else</span> 
        <span class="keyword">if</span>(dot(b,a,c)&gt;<span class="number">0</span>&amp;&amp;dot(c,a,b)&gt;<span class="number">0</span>)
        {
            <span class="keyword">double</span> angle1=<span class="number">2</span>*<span class="built_in">acos</span>(h/r);
            <span class="keyword">return</span> <span class="number">0.5</span>*r*r*<span class="built_in">fabs</span>(angle-angle1)+<span class="number">0.5</span>*r*r*<span class="built_in">sin</span>(angle1);
        }<span class="keyword">else</span> <span class="keyword">return</span> <span class="number">0.5</span>*r*r*angle;
    }<span class="keyword">else</span> 
        <span class="keyword">if</span>(dis(a,b)&lt;r+eps&amp;&amp;dis(a,c)&lt;r+eps) <span class="keyword">return</span> <span class="number">0.5</span>*<span class="built_in">fabs</span>(cross(a,b,c));<span class="comment">//两个端点都在圆内的情况</span>
        <span class="keyword">else</span><span class="comment">//一个端点在圆上一个端点在圆内的情况</span>
        {
            <span class="keyword">if</span>(dis(a,b)&gt;dis(a,c)) swap(b,c);<span class="comment">//默认b在圆内</span>
            <span class="keyword">if</span>(<span class="built_in">fabs</span>(dis(a,b))&lt;eps) <span class="keyword">return</span> <span class="number">0.0</span>;<span class="comment">//ab距离为0直接返回0</span>
            <span class="keyword">if</span>(dot(b,a,c)&lt;eps)
            {
                <span class="keyword">double</span> angle1=<span class="built_in">acos</span>(h/dis(a,b));
                <span class="keyword">double</span> angle2=<span class="built_in">acos</span>(h/r)-angle1;
                <span class="keyword">double</span> angle3=<span class="built_in">acos</span>(h/dis(a,c))-<span class="built_in">acos</span>(h/r);
                <span class="keyword">return</span> <span class="number">0.5</span>*dis(a,b)*r*<span class="built_in">sin</span>(angle2)+<span class="number">0.5</span>*r*r*angle3;
            }<span class="keyword">else</span>
            {
                <span class="keyword">double</span> angle1=<span class="built_in">acos</span>(h/dis(a,b));
                <span class="keyword">double</span> angle2=<span class="built_in">acos</span>(h/r);
                <span class="keyword">double</span> angle3=<span class="built_in">acos</span>(h/dis(a,c))-angle2;
                <span class="keyword">return</span> <span class="number">0.5</span>*r*dis(a,b)*<span class="built_in">sin</span>(angle1+angle2)+<span class="number">0.5</span>*r*r*angle3;
            }
        }
}
<span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>
<span class="function"></span>{
    <span class="keyword">int</span> T,n=<span class="number">4</span>;
    <span class="keyword">double</span> rx,ry,R;
    <span class="built_in">scanf</span>(<span class="string">"%lf%lf%lf"</span>,&amp;rx,&amp;ry,&amp;R);
    <span class="built_in">scanf</span>(<span class="string">"%lf%lf%lf%lf"</span>,&amp;p[<span class="number">1</span>].x,&amp;p[<span class="number">1</span>].y,&amp;p[<span class="number">3</span>].x,&amp;p[<span class="number">3</span>].y);
    p[<span class="number">2</span>].x=p[<span class="number">1</span>].x;p[<span class="number">2</span>].y=p[<span class="number">3</span>].y;
    p[<span class="number">4</span>].x=p[<span class="number">3</span>].x;p[<span class="number">4</span>].y=p[<span class="number">1</span>].y;
    p[<span class="number">5</span>]=p[<span class="number">1</span>];
    <span class="function">Point <span class="title">O</span><span class="params">(rx,ry)</span></span>;
    <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n+<span class="number">1</span>;i++) p[i]=p[i]-O;
    O=Point(<span class="number">0</span>,<span class="number">0</span>);
    <span class="keyword">double</span> sum=<span class="number">0</span>;
    <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;i++)
    {
        <span class="keyword">int</span> j=i+<span class="number">1</span>;
        <span class="keyword">double</span> s=area(p[i],p[j],R);
        <span class="keyword">if</span> (cross(O,p[i],p[j])&gt;<span class="number">0</span>) sum+=s;<span class="keyword">else</span> sum-=s;
    }
    <span class="built_in">printf</span>(<span class="string">"%.4lf\n"</span>,<span class="built_in">fabs</span>(sum));
    <span class="keyword">return</span> <span class="number">0</span>;
}</code></pre>
